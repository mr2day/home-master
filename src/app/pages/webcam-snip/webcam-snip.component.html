<div class="webcam-container">
  <div class="webcam-wrapper">
    <video
      #videoElement
      class="webcam-video"
      autoplay
      playsinline
    ></video>

    @if (errorMessage) {
      <div class="error-message">
        {{ errorMessage }}
      </div>
    }
  </div>
  <div class="left-controls">
    <div class="focus-control">
      <label for="shutter-speed-input">Shutter</label>
      <div class="focus-input-group">
        <button class="focus-btn" (click)="adjustShutterSpeedBy(1)">+</button>
        <input
          id="shutter-speed-input"
          type="text"
          [value]="shutterLabel()"
          readonly
          class="focus-input"
        />
        <button class="focus-btn" (click)="adjustShutterSpeedBy(-1)">-</button>
      </div>
    </div>
    <div class="focus-control">
      <label for="focus-input">Focus</label>
      <div class="focus-input-group">
        <button class="focus-btn" (click)="adjustFocusBy(10)">+</button>
        <input
          id="focus-input"
          type="text"
          [value]="focusValue()"
          (change)="onFocusInputChange($event)"
          class="focus-input"
        />
        <button class="focus-btn" (click)="adjustFocusBy(-10)">-</button>
      </div>
    </div>
    <div class="focus-control">
      <label for="resolution-input">Resolution</label>
      <div class="focus-input-group">
        <select
          id="resolution-input"
          [value]="resolutionValue()"
          (change)="onResolutionInputChange($event)"
          class="resolution-select"
        >
          @for (res of availableResolutions(); track $index) {
            <option
              [value]="res.width + 'x' + res.height"
              [selected]="(res.width + 'x' + res.height) === resolutionValue()"
            >
              {{ res.width + 'x' + res.height }}
            </option>
          }
        </select>
      </div>
    </div>
  </div>
  <div class="button-group">
    <div class="controls-column">
      <div class="action-controls">
        <div class="buttons">
          <h-button
            [label]="isRecording() ? 'Recording' : 'Record'"
            [size]="'sm'"
            [ratio]="'square'"
            [ledState]="isRecording() ? 'on' : 'off'"
            [ledColor]="'red'"
            [ledBlink]="isRecording()"
            [showAsyncStates]="false"
            [action]="toggleRecordingAction"
          ></h-button>
          <h-button
            [label]="'Snip'"
            [size]="'md'"
            [ratio]="'square'"
            [action]="snipAction"
          ></h-button>
          <h-button
            [label]="dccService.isConnected() ? 'DCC Connected' : 'Connect DCC'"
            [size]="'sm'"
            [ratio]="'square'"
            [ledState]="dccService.isConnected() ? 'on' : 'off'"
            [action]="toggleDccConnectionAction"
          ></h-button>
          @if (dccService.isConnected()) {
            <h-button
              [label]="'Test'"
              [size]="'sm'"
              [ratio]="'square'"
              [action]="testDccAction"
            ></h-button>
          }
        </div>
      </div>
    </div>
  </div>
</div>
